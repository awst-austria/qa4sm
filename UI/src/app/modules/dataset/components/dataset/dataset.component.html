<div class="grid align-content-center">
  <div class="col" style="max-width: 100%">
    <p-floatLabel class="mb-4 mt-3">
      <p-select
        [inputId]="datasetSelectorId"
        (onChange)="updateSelectableVersionsAndVariableAndEmmit()"
        [options]="(datasets$|async)"
        [(ngModel)]="selectionModel.selectedDataset"
        optionLabel="pretty_name" [style]="{'width': '100%'}">
          <ng-template let-item pTemplate="item">
            <span>{{ item.pretty_name }}
              <em *ngIf="authService.authenticated.value">
                {{item.user === authService.currentUser.id ? "  (user data)" :
                  (item.user !== authService.currentUser.id && item.is_shared ? ' (shared data)' : "")}}
              </em>
            </span>
          </ng-template>

          <ng-template let-item pTemplate="selectedItem">
            <span>{{ item.pretty_name }}
              <em *ngIf="authService.authenticated.value">
                {{item.user === authService.currentUser.id ? "  (user data)" :
               (item.user !== authService.currentUser.id && item.is_shared ? " (shared data)" : "")}}
              </em>
            </span>
          </ng-template>
      </p-select>
      <label for="{{datasetSelectorId}}">Dataset name</label>
    </p-floatLabel>
  </div>
</div>

<div class="grid  align-content-center">
  <div class="col" style="max-width: 100%">
    <p-floatLabel class="mb-4" *ngIf="(selectableDatasetVersions$|async) as selectedVersions">
      <p-select [inputId]="versionSelectorId"
                  [style]="{'width': '100%'}"
                  [options]="selectedVersions"
                  [(ngModel)]="selectionModel.selectedVersion"
                  optionLabel="pretty_name"
                  (onChange)="onVersionChange(selectedVersions)">

        <ng-template let-item pTemplate="item">
          <span>{{ item.pretty_name }}
            <em class="text-muted" *ngIf="item.id === newestVersionId"> (newest version)</em>
          </span>
        </ng-template>
        <ng-template let-item pTemplate="selectedItem">
          <span>{{ item.pretty_name }}
            <em class="text-muted" *ngIf="item.id === newestVersionId"> (newest version)</em>
          </span>
        </ng-template>
      </p-select>
      <label for="{{versionSelectorId}}">Dataset version <span *ngIf="newerVersionExists" class='warning-text'> (newer version available!) </span></label>
    </p-floatLabel>
  </div>
</div>

<div class="grid  align-content-center">
  <div class="col" style="max-width: 100%">
    <p-floatLabel>
      <p-select 
        [inputId]="variableSelectorId" 
        optionLabel="short_name" 
        [style]="{'width': '100%'}"     
        [options]="(selectableDatasetVariables$|async)"          
        [(ngModel)]="selectionModel.selectedVariable"
      >
        <ng-template let-item pTemplate="item">
          <span>
            {{ item.display_name === 'none' ? item.pretty_name : item.display_name }}
            [{{ item.unit ? item.unit : 'n.a.' }}]
          </span>
        </ng-template>
        
        <ng-template let-item pTemplate="selectedItem">
          <span>
            {{ item.display_name === 'none' ? item.pretty_name : item.display_name }}
            [{{ item.unit ? item.unit : 'n.a.' }}]
          </span>
        </ng-template>
      </p-select>
      <label for="{{variableSelectorId}}">Variable [units]</label>
    </p-floatLabel>
  </div>
</div>

