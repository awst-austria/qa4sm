<ng-container *ngIf="display$ | async as display">
  <div class="form-background" [class.open]="display === 'open'" (click)="close()">
    <p-panel class="publishing-form" (click)="$event.stopPropagation()">
      <div (click)="$event.stopPropagation()">
        <button class="close"
                type="button"
                (click)="close()">X
        </button>
      </div>
      <ng-template pTemplate="header">
        <h4 class="my-0 font-weight-normal" id="publishDialogTitle">Publish results</h4>
      </ng-template>
      <div class="p-px-0 p-py-0">
        <p class="p-my-0">
          Please check the metadata your results will be published with. <br/>
          If you want to permanently set your author details, you can do so on your <a routerLink="/user-profile">profile
          page</a>.
        </p>
      </div>
      <form [formGroup]="publishingForm" (ngSubmit)="publish()">
        <div class="p-pt-3 p-pb-2 p-grid">
          <span class="label p-col-2">
            <label for="title">Title</label>
          </span>
          <textarea class="form-field p-col"
                 id="title"
                 type="text"
                 pInputText
                 formControlName="title">
          </textarea>
          <span title="Title of the Zenodo entry"
                class="pi pi-question-circle p-col-1 help-field">
          </span>
        </div>

        <div class="p-py-2 p-grid">
          <span class="label p-col-2">
            <label for="description">Description</label>
          </span>
          <textarea class="form-field p-col"
                    id="description"
                    type="text"
                    pInputText
                    formControlName="description">
          </textarea>
          <span title="Description of the Zenodo entry"
                class="pi pi-question-circle p-col-1 help-field">
          </span>
        </div>

        <div class="p-py-2 p-grid">
          <span class="label p-col-2">
            <label for="keywords">Keywords</label>
          </span>
          <textarea
            class="form-field p-col"
            id="keywords"
            type="text"
            pInputText
            formControlName="keywords">
          </textarea>
          <span
            title="Comma-separated list of keywords to make your results easily searchable; must contain keyword 'qa4sm'"
            class="pi pi-question-circle p-col-1 help-field">
          </span>
        </div>

        <div class="p-py-2 p-grid">
        <span class="label p-col-2">
          <label for="name">Name</label>
        </span>
          <input class="form-field p-col" id="name" type="text" pInputText formControlName="name">
          <span title="Your name; format: Lastname, Firstnames"
                class="pi pi-question-circle p-col-1 help-field">
          </span>

        </div>

        <div class="p-py-2 p-grid">
        <span class="label p-col-2">
          <label for="affiliation">Affiliation</label>
        </span>
          <input class="form-field p-col" id="affiliation" type="text" pInputText formControlName="affiliation">
          <span title="Your organisation or other affiation, optional"
                class="pi pi-question-circle p-col-1 help-field">
          </span>
        </div>

        <div class="p-pt-2 p-mb-3 p-grid">
        <span class="label p-col-2">
          <label for="orcid">ORCID</label>
        </span>
          <input class="form-field p-col" id="orcid" type="text" pInputText formControlName="orcid">
          <span title="Your personal ORCID id, optional"
                class="pi pi-question-circle p-col-1 help-field">
          </span>

        </div>
        <b>Please note:</b>
        Publishing the result can't be undone and you won't be able to delete the result nor change its metadata
        (including the validation name) later.<br/>
        Publishing can take a few minutes, please be patient.

      </form>


      <!--      <div class="modal" id="publishDialog" role="dialog" aria-labelledby="publishDialogTitle" aria-hidden="true">-->
      <!--        <div class="modal-dialog modal-lg" role="document">-->
      <!--          <div class="modal-content">-->

      <!--            <form id="publishing_form">-->

      <!--              <div class="modal-header">-->
      <!--                <h4 class="my-0 font-weight-normal" id="publishDialogTitle">Publish results</h4>-->
      <!--              </div>-->

      <!--              <div class="modal-body">-->

      <!--                <p>-->
      <!--                  Please check the metadata your results will be published with. <br/>-->
      <!--                  If you want to permanently set your author details, you can do so on your-->
      <!--&lt;!&ndash;                  <a href="{% url 'user_profile' %}">profile page</a>.&ndash;&gt;-->
      <!--                </p>-->

      <!--                <div class="custom-invalid-feedback">-->
      <!--                </div>-->
      <!--                <div *ngIf="publishingForm$|async as publishingForm">-->
      <!--                  {{publishingForm.title}}-->
      <!--                </div>-->

      <!--&lt;!&ndash;                {% for field in publishing_form.visible_fields %}&ndash;&gt;-->
      <!--&lt;!&ndash;                <div class="row mb-2">&ndash;&gt;-->
      <!--&lt;!&ndash;                  <div class="col">&ndash;&gt;-->
      <!--&lt;!&ndash;                    <div class="input-group">&ndash;&gt;-->
      <!--&lt;!&ndash;                      <div class="input-group-prepend">&ndash;&gt;-->
      <!--&lt;!&ndash;                        <span class="input-group-text addon-w-pub">{{field.label}}</span>&ndash;&gt;-->
      <!--&lt;!&ndash;                      </div>&ndash;&gt;-->

      <!--&lt;!&ndash;                      {% render_field field class="form-control" title=field.help_text %}&ndash;&gt;-->

      <!--&lt;!&ndash;                      {% if field.help_text %}&ndash;&gt;-->
      <!--&lt;!&ndash;                      <div class="input-group-append">&ndash;&gt;-->
      <!--&lt;!&ndash;                        <span class="input-group-text fas fa-question-circle" title="{{ field.help_text }}"></span>&ndash;&gt;-->
      <!--&lt;!&ndash;                      </div>&ndash;&gt;-->
      <!--&lt;!&ndash;                      {% endif %}&ndash;&gt;-->
      <!--&lt;!&ndash;                    </div>&ndash;&gt;-->

      <!--&lt;!&ndash;                    {% for error in field.errors %}&ndash;&gt;-->
      <!--&lt;!&ndash;                    <div class="custom-invalid-feedback">&ndash;&gt;-->
      <!--&lt;!&ndash;                      {{ error }}&ndash;&gt;-->
      <!--&lt;!&ndash;                    </div>&ndash;&gt;-->
      <!--&lt;!&ndash;                    {% endfor %}&ndash;&gt;-->
      <!--&lt;!&ndash;                  </div>&ndash;&gt;-->
      <!--&lt;!&ndash;                </div>&ndash;&gt;-->
      <!--&lt;!&ndash;                {% endfor %}&ndash;&gt;-->

      <!--                <p class="mt-3 mb-0">-->
      <!--                  <b>Please note:</b>-->
      <!--                  Publishing the result can't be undone and you won't be able to delete the result nor change its metadata (including the validation name) later.<br/>-->
      <!--                  Publishing can take a few minutes, please be patient.-->
      <!--                </p>-->
      <!--              </div>-->

      <!--              <div class="modal-footer">-->
      <!--                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>-->
      <!--                <button class="btn btn-primary" title="Publish on Zenodo" type="button" (click)="publish()">Publish now!</button>-->
      <!--              </div>-->

      <!--&lt;!&ndash;              {% endwith %}&ndash;&gt;-->

      <!--            </form>-->

      <!--          </div>-->
      <!--        </div>-->
      <!--      </div>-->

    </p-panel>
  </div>
</ng-container>
